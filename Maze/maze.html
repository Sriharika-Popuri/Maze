<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Maze Game</title>
  <style>
    /* Base Styles */
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      transition: background-color 0.3s, color 0.3s;
    }

    .container {
      padding: 20px;
      max-width: 800px;
      margin: auto;
    }

    header {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .user-info {
      margin: 10px 0;
    }

    .controls {
      margin: 10px 0;
    }

    button {
      padding: 10px 20px;
      margin: 5px;
      cursor: pointer;
      border: none;
      border-radius: 5px;
      background-color: #2196F3;
      color: white;
      font-size: 16px;
      transition: background-color 0.3s;
    }

    button:hover {
      background-color: #1976D2;
    }

    /* Light Theme */
    body.light-mode {
      background-color: #ffffff;
      color: #000000;
    }

    /* Dark Theme */
    body.dark-mode {
      background-color: #121212;
      color: #ffffff;
    }

    .name-input {
      display: flex;
      justify-content: center;
      margin: 20px 0;
    }

    .name-input input {
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 5px 0 0 5px;
      outline: none;
      width: 200px;
    }

    .name-input button {
      padding: 10px 20px;
      border: none;
      border-radius: 0 5px 5px 0;
      background-color: #4CAF50;
      color: white;
      font-size: 16px;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    .name-input button:hover {
      background-color: #45A049;
    }

    /* Maze Styles */
    .maze {
      display: grid;
      grid-template-rows: repeat(10, 50px);
      grid-template-columns: repeat(10, 50px);
      gap: 2px;
      justify-content: center;
      margin: 20px auto;
      position: relative;
      user-select: none;
    }

    .cell {
      width: 50px;
      height: 50px;
      background-color: #4CAF50;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      position: relative;
      transition: background-color 0.3s;
    }

    .start {
      background-color: #2196F3;
      cursor: default;
    }

    .end {
      background-color: #f44336;
      cursor: default;
    }

    .wall {
      background-color: #000000;
    }

    .player {
      background-color: #FFD700;
      width: 90%;
      height: 90%;
      border-radius: 50%;
    }

    /* Timer */
    .timer {
      text-align: center;
      font-size: 20px;
      margin-top: 10px;
    }

    /* Modal Styles */
    .modal {
      display: none; /* Hidden by default */
      position: fixed; 
      z-index: 1; 
      padding-top: 100px; 
      left: 0;
      top: 0;
      width: 100%; 
      height: 100%; 
      overflow: auto; 
      background-color: rgba(0,0,0,0.4); 
    }

    .modal-content {
      background-color: #fefefe;
      margin: auto;
      padding: 20px;
      border: 1px solid #888;
      width: 80%;
      max-width: 400px;
      text-align: center;
      border-radius: 10px;
      position: relative;
    }

    .close-button {
      color: #aaa;
      position: absolute;
      top: 10px;
      right: 20px;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
    }

    .close-button:hover,
    .close-button:focus {
      color: black;
    }

    body.dark-mode .modal-content {
      background-color: #333;
      color: #fff;
    }

    @media (max-width: 600px) {
      .maze {
        grid-template-rows: repeat(10, 40px);
        grid-template-columns: repeat(10, 40px);
      }

      .cell {
        width: 40px;
        height: 40px;
      }

      .player {
        width: 90%;
        height: 90%;
      }

      button {
        font-size: 14px;
        padding: 8px 16px;
      }

      .name-input input {
        width: 150px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Maze Game</h1>
      <div class="user-info">
        <span id="player-name">Player: Guest</span>
        <span id="times-played">Times Played: 0</span>
      </div>
      <div class="controls">
        <button id="toggle-theme">Toggle Dark Mode</button>
        <button id="start-button">Start Game</button>
      </div>
    </header>

    <section class="name-input">
      <input type="text" id="name-input" placeholder="Enter your name">
      <button id="submit-name">Submit</button>
    </section>

    <section class="maze" id="maze">
      <!-- Maze cells will be generated by JavaScript -->
    </section>

    <div class="timer">
      Time: <span id="timer">0</span> seconds
    </div>

    <!-- Modal for displaying results -->
    <div id="result-modal" class="modal">
      <div class="modal-content">
        <span class="close-button">&times;</span>
        <h2>Congratulations, <span id="modal-name">Player</span>!</h2>
        <p>You completed the maze in <span id="modal-time">0</span> seconds.</p>
        <button id="close-modal">Close</button>
      </div>
    </div>
  </div>

  <script>
    // Elements
    const toggleThemeBtn = document.getElementById('toggle-theme');
    const startButton = document.getElementById('start-button');
    const nameInput = document.getElementById('name-input');
    const submitNameBtn = document.getElementById('submit-name');
    const playerNameSpan = document.getElementById('player-name');
    const timesPlayedSpan = document.getElementById('times-played');
    const timerSpan = document.getElementById('timer');
    const modal = document.getElementById('result-modal');
    const closeButton = document.querySelector('.close-button');
    const closeModalBtn = document.getElementById('close-modal');
    const modalName = document.getElementById('modal-name');
    const modalTime = document.getElementById('modal-time');
    const mazeContainer = document.getElementById('maze');

    // Game Variables
    let darkMode = false;
    let timer = 0;
    let timerInterval;
    let timesPlayed = 0;
    let playerName = 'Guest';
    let gameStarted = false;
    let playerPosition = { row: 0, col: 0 };

    // Maze Configuration (10x10 grid)
    const mazeLayout = [
      ['start', 'path', 'wall', 'path', 'path', 'path', 'wall', 'path', 'path', 'path'],
      ['wall', 'path', 'wall', 'path', 'wall', 'path', 'wall', 'path', 'wall', 'path'],
      ['wall', 'path', 'path', 'path', 'wall', 'path', 'path', 'path', 'wall', 'path'],
      ['wall', 'wall', 'wall', 'path', 'wall', 'wall', 'wall', 'path', 'wall', 'path'],
      ['path', 'path', 'path', 'path', 'path', 'path', 'wall', 'path', 'path', 'path'],
      ['wall', 'path', 'wall', 'wall', 'wall', 'path', 'wall', 'wall', 'wall', 'path'],
      ['path', 'path', 'path', 'path', 'wall', 'path', 'path', 'path', 'path', 'path'],
      ['path', 'wall', 'wall', 'path', 'wall', 'wall', 'wall', 'wall', 'wall', 'path'],
      ['path', 'path', 'path', 'path', 'path', 'path', 'path', 'path', 'end', 'path'],
      ['wall', 'wall', 'wall', 'wall', 'wall', 'wall', 'wall', 'wall', 'wall', 'wall']
    ];

    // Initialize Maze
    function initializeMaze() {
      mazeContainer.innerHTML = ''; // Clear existing maze
      for (let row = 0; row < mazeLayout.length; row++) {
        for (let col = 0; col < mazeLayout[row].length; col++) {
          const cell = document.createElement('div');
          cell.classList.add('cell');
          const cellType = mazeLayout[row][col];
          cell.dataset.row = row;
          cell.dataset.col = col;

          if (cellType === 'start') {
            cell.classList.add('start');
            cell.textContent = 'Start';
            playerPosition = { row: row, col: col };
          } else if (cellType === 'end') {
            cell.classList.add('end');
            cell.textContent = 'End';
          } else if (cellType === 'wall') {
            cell.classList.add('wall');
          }

          mazeContainer.appendChild(cell);
        }
      }

      // Add player to the start position
      updatePlayerPosition(playerPosition.row, playerPosition.col);
    }

    // Update Player Position
    function updatePlayerPosition(row, col) {
      // Remove existing player
      const existingPlayer = document.querySelector('.player');
      if (existingPlayer) {
        existingPlayer.parentElement.classList.remove('player-cell');
        existingPlayer.remove();
      }

      // Add player to the new cell
      const selector = `.cell[data-row='${row}'][data-col='${col}']`;
      const newCell = document.querySelector(selector);
      if (newCell && !newCell.classList.contains('wall') && !newCell.classList.contains('end')) {
        const player = document.createElement('div');
        player.classList.add('player');
        newCell.appendChild(player);
        newCell.classList.add('player-cell');
        playerPosition = { row, col };
      }
    }

    // Handle Key Presses for Player Movement
    function handleKeyPress(event) {
      if (!gameStarted) return;

      const key = event.key;
      let newRow = playerPosition.row;
      let newCol = playerPosition.col;

      if (key === 'ArrowUp') {
        newRow -= 1;
      } else if (key === 'ArrowDown') {
        newRow += 1;
      } else if (key === 'ArrowLeft') {
        newCol -= 1;
      } else if (key === 'ArrowRight') {
        newCol += 1;
      } else {
        return; // Ignore other keys
      }

      // Check boundaries
      if (newRow < 0 || newRow >= mazeLayout.length || newCol < 0 || newCol >= mazeLayout[0].length) {
        return;
      }

      // Check if the next cell is a wall
      if (mazeLayout[newRow][newCol] === 'wall') {
        return;
      }

      // Update player position
      updatePlayerPosition(newRow, newCol);

      // Check if reached end
      if (mazeLayout[newRow][newCol] === 'end') {
        endGame();
      }
    }

    // Toggle Theme
    toggleThemeBtn.addEventListener('click', () => {
      darkMode = !darkMode;
      document.body.classList.toggle('dark-mode', darkMode);
      document.body.classList.toggle('light-mode', !darkMode);
      toggleThemeBtn.textContent = darkMode ? 'Toggle Light Mode' : 'Toggle Dark Mode';
    });

    // Submit Name
    submitNameBtn.addEventListener('click', () => {
      const name = nameInput.value.trim();
      if (name !== '') {
        playerName = name;
        playerNameSpan.textContent = `Player: ${playerName}`;
        nameInput.value = '';
      }
    });

    // Start Game
    startButton.addEventListener('click', () => {
      resetGame();
      startTimer();
      gameStarted = true;
      mazeContainer.focus();
    });

    // Reset Game
    function resetGame() {
      timer = 0;
      timerSpan.textContent = timer;
      clearInterval(timerInterval);
      gameStarted = false;
      initializeMaze();
    }

    // Start Timer
    function startTimer() {
      timerInterval = setInterval(() => {
        timer += 1;
        timerSpan.textContent = timer;
      }, 1000);
    }

    // End Game
    function endGame() {
      clearInterval(timerInterval);
      gameStarted = false;
      timesPlayed += 1;
      timesPlayedSpan.textContent = `Times Played: ${timesPlayed}`;
      localStorage.setItem('timesPlayed', timesPlayed);
      showModal();
    }

    // Show Modal
    function showModal() {
      modalName.textContent = playerName;
      modalTime.textContent = timer;
      modal.style.display = 'block';
    }

    // Close Modal
    closeButton.addEventListener('click', () => {
      modal.style.display = 'none';
    });

    closeModalBtn.addEventListener('click', () => {
      modal.style.display = 'none';
    });

    // Close Modal when clicking outside the content
    window.addEventListener('click', (event) => {
      if (event.target == modal) {
        modal.style.display = 'none';
      }
    });

    // Handle Keyboard Input for Player Movement
    window.addEventListener('keydown', handleKeyPress);

    // Initialize Times Played from localStorage
    if (localStorage.getItem('timesPlayed')) {
      timesPlayed = parseInt(localStorage.getItem('timesPlayed'));
      timesPlayedSpan.textContent = `Times Played: ${timesPlayed}`;
    }

    // Initialize Theme and Maze on Page Load
    window.addEventListener('load', () => {
      document.body.classList.add('light-mode');
      initializeMaze();
    });
  </script>
</body>
</html>
